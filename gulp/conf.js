// config

const D = {
  PATH: '/figleditr',
  SRC: 'src',
  DEST: 'public'
};

export default {

  D,

  serve: {
    notify: false,
    startPath: D.PATH,
    server: {
      baseDir: './',
      index: `${D.DEST}${D.PATH}/`,
      routes: {
        [D.PATH]: `${D.DEST}/`,
        [`${D.PATH}/fonts`]: `${D.DEST}/fonts`
      }
    }
  },

  scripts: {
    browserifyOpts: {
      entries: [`./${D.SRC}/js/index.js`],
      extensions: ['.jsx'],
      transform: [['babelify', { 'stage': 1 }], 'envify']
    },
    dest: `${D.DEST}/js`
  },

  uglify: {
    src: `./${D.DEST}/js/index.js`,
    dest: `${D.DEST}/js`,
    opts: {
      preserveComments(node, comment) {
        return comment.value.indexOf('This header is generated by licensify') > -1;
      }
    }
  },

  jade: {
    src: [
      `${D.SRC}/**/*.jade`,
      `!${D.SRC}/**/_**/*.jade`,
      `!${D.SRC}/**/_*.jade`
    ],
    dest: `${D.DEST}`
  },

  stylus: {
    src: [
      `${D.SRC}/**/*.styl`,
      `!${D.SRC}/**/_**/*.styl`,
      `!${D.SRC}/**/_*.styl`
    ],
    dest: `${D.DEST}/css`
  },

  minifyCss: {
    src: `${D.DEST}/css/main.css`,
    dest: `${D.DEST}/css`
  },

  clean: {
    path: [`${D.DEST}`]
  },

  copy: {
    figlet: {
      src: './node_modules/figlet/fonts/**',
      dest: `${D.DEST}/fonts`
    }
  },

  replace: {
    src: `${D.DEST}/index.html`,
    dest: `${D.DEST}`,
    replacements: [
      ['index.js?v', `index.min.js?v=${Date.now()}`],
      ['main.css?v', `main.min.css?v=${Date.now()}`]
    ]
  }

}
